"use strict";(self.webpackChunklyra_exporter_english=self.webpackChunklyra_exporter_english||[]).push([[22],{22:(t,s,e)=>{e.d(s,{exportChatAsMarkdown:()=>n,saveTextFile:()=>u});const n=(t,s)=>{const{meta_info:e,chat_history:n}=t,u=[];if(s.exportObsidianMetadata&&(u.push("---"),u.push("title: ".concat(e.title||"\u5bf9\u8bdd\u8bb0\u5f55")),u.push("date: ".concat((new Date).toISOString().split("T")[0])),s.obsidianProperties&&s.obsidianProperties.length>0&&s.obsidianProperties.forEach(t=>{const{name:s,value:e}=t;if(e.includes(",")&&!e.includes("[")){const t=e.split(",").map(t=>t.trim());u.push("".concat(s,":")),t.forEach(t=>{u.push("  - ".concat(t))})}else u.push("".concat(s,": ").concat(e))}),s.obsidianTags&&s.obsidianTags.length>0&&(u.push("tags:"),s.obsidianTags.forEach(t=>{u.push("  - ".concat(t))})),u.push("---"),u.push("")),u.push("# ".concat(e.title||"\u5bf9\u8bdd\u8bb0\u5f55")),u.push("*\u521b\u5efa\u65f6\u95f4: ".concat(e.created_at||"\u672a\u77e5","*")),u.push("*\u5bfc\u51fa\u65f6\u95f4: ".concat((new Date).toLocaleString("zh-CN"),"*")),s.exportMarkedOnly&&u.push("*\u5bfc\u51fa\u7c7b\u578b: \u4ec5\u5305\u542b\u5df2\u5b8c\u6210\u6807\u8bb0\u7684\u6d88\u606f*"),u.push(""),u.push("---"),u.push(""),!n||0===n.length)return u.push("*\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u6d88\u606f*"),u.join("\n");let h=0;return n.forEach(t=>{var e;if(s.exportMarkedOnly&&(null===(e=s.markedItems)||void 0===e||!e.has(t.index)))return;h++;const n=t.sender_label,c=t.timestamp,a=t.index+1;let p="";t.is_branch_point?p=" \ud83d\udd00":t.branch_level>0&&(p=" \u21b3".concat(t.branch_level)),u.push("## ".concat(a,". ").concat(n).concat(p)),s.includeTimestamps&&u.push("*".concat(c,"*")),u.push(""),t.display_text&&(u.push(t.display_text),u.push("")),t.thinking&&s.includeThinking&&(u.push("<details>"),u.push("<summary>\u601d\u8003\u8fc7\u7a0b</summary>"),u.push(""),u.push("```"),u.push(t.thinking),u.push("```"),u.push("</details>"),u.push("")),t.artifacts&&t.artifacts.length>0&&s.includeArtifacts&&t.artifacts.forEach(t=>{const s=t.id||"\u672a\u77e5",e=t.type||"\u672a\u77e5",n=t.title||"\u65e0\u6807\u9898";u.push("<details>"),u.push("<summary>Artifact: ".concat(n," (ID: ").concat(s,")</summary>")),u.push(""),u.push("**\u7c7b\u578b**: `".concat(e,"`")),u.push("");const h=t.command||"";if("create"===h){const s=t.content||"",e=t.language||"";e?(u.push("**\u8bed\u8a00**: `".concat(e,"`")),u.push(""),u.push("**\u5185\u5bb9**:"),u.push("```".concat(e)),u.push(s),u.push("```")):(u.push("**\u5185\u5bb9**:"),u.push("```"),u.push(s),u.push("```"))}else if("update"===h||"rewrite"===h){const s=t.old_str||"",e=t.new_str||"";u.push("**\u64cd\u4f5c**: `".concat(h,"`")),u.push(""),u.push("**\u539f\u59cb\u6587\u672c**:"),u.push("```"),u.push(s),u.push("```"),u.push(""),u.push("**\u65b0\u6587\u672c**:"),u.push("```"),u.push(e),u.push("```")}u.push("</details>"),u.push("")}),t.tools&&t.tools.length>0&&s.includeTools&&t.tools.forEach(t=>{const s=t.name;if(u.push("<details>"),u.push("<summary>\u5de5\u5177: ".concat(s,"</summary>")),u.push(""),"web_search"===s&&t.query&&(u.push("**\u641c\u7d22\u67e5\u8be2**: `".concat(t.query,"`")),u.push("")),t.input&&"object"===typeof t.input){u.push("**\u8f93\u5165\u53c2\u6570**:"),u.push("```json");try{u.push(JSON.stringify(t.input,null,2))}catch(e){u.push(String(t.input))}u.push("```"),u.push("")}if(t.result&&(u.push("**\u7ed3\u679c**:"),t.result.is_error&&(u.push("> \u26a0\ufe0f \u5de5\u5177\u6267\u884c\u51fa\u9519"),u.push("")),"web_search"===s)){const s=t.result.content||[],e=Math.min(s.length,5);if(s.length>0){u.push("\u641c\u7d22\u7ed3\u679c:"),u.push("");for(let t=0;t<e;t++){const e=s[t];if(!e||"object"!==typeof e)continue;const n=e.title||"\u65e0\u6807\u9898",h=e.url||"#";u.push("".concat(t+1,". [").concat(n,"](").concat(h,")"))}s.length>e&&u.push("*...\u8fd8\u6709 ".concat(s.length-e," \u4e2a\u7ed3\u679c\u672a\u663e\u793a*")),u.push("")}}u.push("</details>"),u.push("")}),t.citations&&t.citations.length>0&&s.includeCitations&&(u.push("<details>"),u.push("<summary>\u5f15\u7528\u6765\u6e90</summary>"),u.push(""),u.push("| \u6807\u9898 | \u6765\u6e90 |"),u.push("| --- | --- |"),t.citations.forEach(t=>{const s=t.title||"\u672a\u77e5\u6765\u6e90",e=t.url||"#",n=e.includes("/")?e.split("/")[2]:"\u672a\u77e5\u7f51\u7ad9";u.push("| [".concat(s,"](").concat(e,") | ").concat(n," |"))}),u.push("</details>"),u.push("")),u.push("---"),u.push("")}),s.exportMarkedOnly&&(u.push(""),u.push("*\u5171\u5bfc\u51fa ".concat(h," \u6761\u5df2\u5b8c\u6210\u7684\u6d88\u606f*"))),u.join("\n")},u=(t,s)=>{try{const e=new Blob([t],{type:"text/markdown"}),n=URL.createObjectURL(e),u=document.createElement("a");return u.href=n,u.download=s,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(n),!0}catch(e){return console.error("\u4fdd\u5b58\u6587\u4ef6\u5931\u8d25:",e),alert("\u4fdd\u5b58\u6587\u4ef6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"),!1}}}}]);
//# sourceMappingURL=22.976cc530.chunk.js.map